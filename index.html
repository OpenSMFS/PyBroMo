<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="PyBroMo : A single-molecule brownian motion diffusion simulator in confocal geometry.">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>PyBroMo</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/tritemio/PyBroMo">View on GitHub</a>

          <h1 id="project_title">PyBroMo</h1>
          <h2 id="project_tagline">A single-molecule brownian motion diffusion simulator in confocal geometry.</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/tritemio/PyBroMo/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/tritemio/PyBroMo/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a id="pybromo-overview" class="anchor" href="#pybromo-overview" aria-hidden="true"><span class="octicon octicon-link"></span></a>PyBroMo Overview</h1>

<div>
<img title="Numerical PSF" src="https://cloud.githubusercontent.com/assets/4156237/11383966/b5781438-92c0-11e5-982c-0499b95dac43.png" height="110">
<img title="Particles Trajectories" src="https://cloud.githubusercontent.com/assets/4156237/11383974/c3020bae-92c0-11e5-86d7-0f41055e2095.png" height="110">
<img title="Simulated smFRET timetrace, bursts and FRET histogram" src="https://cloud.githubusercontent.com/assets/4156237/11384620/11051666-92c6-11e5-871e-041e71839f22.png" height="110">
</div>

<p><strong><a href="http://tritemio.github.io/PyBroMo/">PyBroMo</a></strong> is an open-source simulator
for Brownian-motion diffusion and photon emission of fluorescent particles
excited by a diffraction limited laser spot.
PyBroMo allows to simulate timestamps of photons emitted during
<a href="http://en.wikipedia.org/wiki/Single-molecule_FRET">smFRET</a> experiments,
including sample background and detectors dark counts and to save the results in
in <a href="http://photon-hdf5.org">Photon-HDF5</a> format. The smFRET data files can
be analyzed with any smFRET burst analysis software.</p>

<blockquote>
<p>For an opensource smFRET burst analysis software supporting Photon-HDF5 see <a href="https://github.com/tritemio/FRETBursts">FRETBursts</a>.</p>
</blockquote>

<p>PyBromo simulates 3-D Brownian motion trajectories and emission of an
arbitrary number of particles freely diffusing in a simulation volume (a box).
Inside the simulation box a laser excitation volume (the
<a href="http://en.wikipedia.org/wiki/Point_spread_function">PSF</a> of the objective lens)
is defined numerically or analytically (Gaussian shape). Particles diffusing
through the excitation volume emit photons at a rate proportional to the
local excitation intensity.</p>

<p>A precomputed numerical <a href="http://en.wikipedia.org/wiki/Point_spread_function">PSF</a>
is included and used by default.
The included numerical PSF is computed through
<a href="http://dx.doi.org/10.1364/JOSAA.27.000295">rigorous vectorial electromagnetic computations</a> using the
<a href="http://onemolecule.chem.uwm.edu/software">PSFLab</a> software.
The user can provide a different numerical PSF or,
alternatively, use an analytical Gaussian-shaped PSF.</p>

<p>An overview of the architecture of the simulator can be found
<a href="#architecture">below</a>.</p>

<p>The user documentation is provided in a series of <a href="http://jupyter.org">Jupyter</a> notebooks
(see <strong><a href="#usage-examples">Usage examples</a></strong>).</p>

<h1>
<a id="feedback" class="anchor" href="#feedback" aria-hidden="true"><span class="octicon octicon-link"></span></a>Feedback</h1>

<p>If you have a question or find a bug in PyBroMo please open a GitHub Issue.
Bug fixes and/or enhancements are welcome, just send a <a href="https://help.github.com/articles/using-pull-requests">pull request (PR)</a>.</p>

<p>For more info contact me at <a href="mailto:tritemio@gmail.com">tritemio@gmail.com</a>.</p>

<h1>
<a id="environment" class="anchor" href="#environment" aria-hidden="true"><span class="octicon octicon-link"></span></a>Environment</h1>

<p>PyBroMo is written in the <a href="http://www.python.org/">python programming language</a>
using the standard scientific stack of libraries (numpy, scipy, pytables,
matplotlib).</p>

<p>Usage examples are given as
Jupyter/IPython notebooks.
<a href="http://jupyter.org/">Jupyter Notebook</a> is an interactive web-based environment that allows to mix rich text, math and graphics with (live) code.
You can find a static HTML version of the notebooks below in section <strong><a href="#usage-examples">Usage examples</a></strong>.</p>

<p>Moreover the <a href="http://ipython.org/">IPython environment</a> allows to easily setup a cluster for parallel computing. Therefore simulation time can be
greatly reduced using a single multi-core PC, multiple PC or a cloud-computing service.</p>

<p>If you are new to Jupyter Notebook, refer to this guide for installation and first steps:</p>

<ul>
<li><a href="http://jupyter-notebook-beginner-guide.readthedocs.org">Jupyter/IPython Notebook Quick Start Guide</a></li>
</ul>

<h1>
<a id="architecture" class="anchor" href="#architecture" aria-hidden="true"><span class="octicon octicon-link"></span></a>Architecture</h1>

<p>The simulation domain is defined as 3-D box, centered around the origin. 
As boundary conditions particles can be either reflected at the interface ("mirror" condition) 
or reinjected from the opposite face ("periodic" condition).</p>

<p>A particle is described by its initial position. A list of particles with random initial position 
is generated by an utility function before running the simulation.</p>

<p>The excitation PSF is a function of the position and is centered with maximum on the origin. 
A realistic PSF obtained by vectorial electromagnetic simulation is precomputed using 
<a href="http://onemolecule.chem.uwm.edu/software">PSFLab</a>. The PSF is computed for a single wavelength 
and includes effects such as refractive index mismatch and mismatch between the objective lens 
correction and the cover-glass thickness. The user can  generate a different PSF using 
<a href="http://onemolecule.chem.uwm.edu/software">PSFLab</a> or equivalent software. The PSF is generated 
using circular polarized light so it has cylindrical symmetry and it is precomputed only on the x-z plane.
Alternatively, a simple Gaussian PSF can also be used.</p>

<p>The Brownian motion parameters are: the diffusion coefficient, the simulation box, 
the list of particles, the simulation time step and the simulation final time.</p>

<p>The Brownian motion simulation uses constant time-steps (typically 0.5 Î¼s).
This allows a straightforward and efficient implementation.
The total simulation time is divided in chunks so that trajectories for a single chunk
easily fit in RAM. For each chunk, trajectories are computed in a single operation, 
integrating the (random) array of displacements with the
<a href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.cumsum.html"><code>cumsum</code></a> command.</p>

<p>The instantaneous emission rate of each particle is computed during the Brownian motion simulation
by evaluating the PSF intensity at each position. After diffusion simulation, for each particle, photons 
are generated from a <a href="http://en.wikipedia.org/wiki/Poisson_process">Poisson process</a> using the 
previously computed emission rates. An additional constant Poisson process models sample background 
and detectors' dark counts. The time bin in which a "count" (photon or background) is extracted
becomes timestamp.</p>

<p>PyBroMo provide functions to simulate one ore multiple FRET populations ins  single step,
saving the results in regular smFRET data files in Photon-HDF5 format. For each timestamp,
the particle ID is also saved allowing to analyze, for example, the number of molecules in each burst.
Photo-physics effects, such as blinking and bleaching, are not explicily 
modeled but they can be easily generated from the smFRET data files. 
However these effect can be easily included simply "modulating" the emission
rates before generating the photons.
Transitions between a two (or more) states with different FRET efficiency can be also 
simulated. In this case, first static smFRET data files are simulted for each state
(using the same diffusion trajectories). Next, the switpoints are computed and a 
new smFRET file is generated taking photons from the different states as function of time.</p>

<p>Finally, the computation can be distributed on the nodes of a cluster (IPython cluster). 
Thanks to the IPython infrastructure the simulation can be seamless run on a single machine, 
on a cluster of machines or on a cloud computing server.</p>

<h1>
<a id="usage-examples" class="anchor" href="#usage-examples" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage examples</h1>

<p>PyBroMo includes a collection of notebooks which serves both as usage examples
and user guide. The notebooks can be read online at:</p>

<ul>
<li><a href="http://nbviewer.ipython.org/github/tritemio/PyBroMo/tree/master/notebooks/">http://nbviewer.ipython.org/github/tritemio/PyBroMo/tree/master/notebooks/</a></li>
</ul>

<p>You may be also interested in a few notebooks on the theory of Brownian motion
simulation (they don't require PyBroMo):</p>

<ul>
<li><a href="http://nbviewer.ipython.org/urls/raw.github.com/tritemio/PyBroMo/master/notebooks/Theory%2520-%2520Introduction%2520to%2520Brownian%2520Motion%2520simulation.ipynb">Theory - Introduction to Brownian Motion simulation</a></li>
<li><a href="http://nbviewer.ipython.org/urls/raw.github.com/tritemio/PyBroMo/master/notebooks/Theory%2520-%2520On%2520Browniam%2520motion%2520and%2520Diffusion%2520coefficient.ipynb">Theory - On Browniam motion and Diffusion coefficient</a></li>
</ul>

<h1>
<a id="acknowledgements" class="anchor" href="#acknowledgements" aria-hidden="true"><span class="octicon octicon-link"></span></a>Acknowledgements</h1>

<p>I wish to thank Xavier Michalet for useful discussions.</p>

<p>This work was supported by NIH grants R01 GM069709 and R01 GM095904.</p>

<h1>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span class="octicon octicon-link"></span></a>License</h1>

<p>PyBroMo - A single molecule FRET diffusion simulator in confocal geometry.</p>

<p>Copyright (C) 2013-2015  Antonino Ingargiola - <a href="mailto:tritemio@gmail.com">tritemio@gmail.com</a></p>

<pre><code>This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
version 2, as published by the Free Software Foundation.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You can find a full copy of the license in the file LICENSE.txt
</code></pre>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">PyBroMo maintained by <a href="https://github.com/tritemio">tritemio</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-44142116-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>


  </body>
</html>
